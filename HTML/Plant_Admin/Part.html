<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Part</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <link rel="stylesheet" href="Part.css">
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>

    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <script>
        var SupplerPart={};
        var PlantPart={};
        windows.onload = function(){
            xmlRequest = new XMLHttpRequest();
            xmlRequest.open("POST", "/Plant_Admin/GetSupplerPart", true);
            xmlRequest.setRequestHeader('Content-type', 'application/json');
            xmlRequest.send();
            xmlRequest.onreadystatechange = function(){
                if((xmlRequest.readyState == 4 ) && (xmlRequest.status == 200)){
                        SupplerPart = JSON.parse(xmlRequest.responseText);
                        {
                            for(var i = 0;i<SupplerPart.length;i++){
                                var json = SupplerPart[i];
                                $("#bodyL").append("" +
                                    "<tr id=\"L"+json.IdPart+"\" onclick=\"color('L"+json.IdPart+"')\">\n" +
                                    "                <td>"+json.PartName+"</td>\n" +
                                    "                <td>"+json.PartDescription+"</td>\n" +
                                    "                <td>"+json.SupplierName+"</td>\n" +
                                    "            </tr>");
                            }
                        }
                    }
                };

            xmlRequest2 = new XMLHttpRequest();
            xmlRequest2.open("POST", "/Plant_Admin/GetPlantPart", true);
            xmlRequest2.setRequestHeader('Content-type', 'application/json');
            xmlRequest2.send();
            xmlRequest2.onreadystatechange = function() {
                if ((xmlRequest2.readyState == 4) && (xmlRequest2.status == 200)) {
                    PlantPart = JSON.parse(xmlRequest2.responseText);
                    for(var i = 0;i<PlantPart.length;i++){
                        var json = PlantPart[i];
                        $("#bodyR").append("" +
                            "<tr id=\"R"+json.IdPart+"\" onclick=\"color('R"+json.IdPart+"')\">\n" +
                            "                <td>"+json.PartName+"</td>\n" +
                            "                <td>"+json.PartDescription+"</td>\n" +
                            "                <td>"+json.Location+"</td>\n" +
                            "                <td>"+json.SupplierName+"</td>\n" +
                            "            </tr>");
                    }
                }
            };
        };

    function Logout(){
    document.getElementById("Logout").submit();
    }
    var destinationPlant = [];
    var removePart = [];
    function color(id){
        if($("#"+id).css("background-color") == "rgb(249, 249, 249)")
        {
            $("#"+id).css("background-color","orange");
            if(id.includes("R"))
            {
                var idPartImp = id.substring(1);
                var lenght = destinationPlant.length;
                destinationPlant[lenght] = idPartImp;
                console.log(destinationPlant);
            }
            else{
                var idPartImp = id.substring(1);
                var lenght = removePart.length;
                removePart[lenght] = idPartImp;
                console.log(removePart);
            }
        }
        else if ($("#"+id).css("background-color") == "rgb(255, 165, 0)")
        {
            $("#"+id).css("background-color","rgb(249, 249, 249)");
            if(id.includes("R"))
            {
                var idPartImp = id.substring(1);
                destinationPlant = arrayRemove(destinationPlant,idPartImp);
                console.log(destinationPlant);
            }
            else{
                var idPartImp = id.substring(1);
                removePart = arrayRemove(removePart,idPartImp);
                console.log(removePart);

            }
        }else if($("#"+id).css("background-color") == "rgb(255, 166, 0)"){
            $("#"+id).css("background-color","rgb(255, 255, 255)");
            if(id.includes("R"))
            {
                var idPartImp = id.substring(1);
                destinationPlant = arrayRemove(destinationPlant,idPartImp);
                console.log(destinationPlant);
            }
            else{
                var idPartImp = id.substring(1);
                removePart = arrayRemove(removePart,idPartImp);
                console.log(removePart);

            }
        }
        else{
            $("#"+id).css("background-color", "rgb(255, 166, 0)");
            if(id.includes("R"))
            {
                var idPartImp = id.substring(1);
                var lenght = destinationPlant.length;
                destinationPlant[lenght] = idPartImp;
                console.log(destinationPlant);
            }
            else{
                var idPartImp = id.substring(1);;
                var lenght = removePart.length;
                removePart[lenght] = idPartImp;
                console.log(removePart);
            }
        }

    }
        function arrayRemove(arr, value) {

            return arr.filter(function(ele){
                return ele != value;
            });

        }
    </script>
</head>
<body>
<header id="navbar">
        <nav class="navbar navbar-default">
        <div class="container-fluid">
        <div class="navbar-header">
        <div class="navbar-brand">
        <p>Identifier</p>
        </div>
        </div>
        <ul class="nav navbar-nav">
        <li><a href="index.html">Operator</a></li>
    <li class="active"><a href="AddOperator.html">Add Operator</a></li>
    <li><a href="Parts.html">Parts</a></li>
    </ul>
    <ul class="nav navbar-nav navbar-right">
        <li><img width="41%" src="../Picture/ERC_Logo.png"></li>
        <li onclick="Logout()"><a href="#"><span class="glyphicon glyphicon-log-in"></span> Logout</a></li>
    <form method="POST" id="Logout" action="/Logout"></form>
        </ul>
        </div>
        </nav>
</header>

<div id="container" class="row">
<div id="tableLeft" class="col-sm-6">
    <h3 class="title text-center">Other Parts</h3>
    <table class="table table-striped border-0">
        <thead>
            <th>PartName</th>
            <th>PartDescription</th>
            <th>SupportName</th>
        </thead>
    </table>
    <div  class="table table-wrapper-scroll-y scrollbar scrollbar-near-moon thin body">
    <table class="table table-striped border-0">
        <tbody id="bodyL">
        </tbody>
    </table>
    </div>
</div>

<div id="tableRight" class="col-sm-6">
    <h3 class="title text-center">Plant's Parts</h3>
    <table class="table table-striped border-0">
        <thead>
            <th>PartName</th>
            <th>PartDescription</th>
            <th>PartLocation</th>
            <th>SupplierName</th>
        </thead>
    </table>
    <div class="table table-wrapper-scroll-y scrollbar scrollbar-near-moon thin body">
        <table class="table table-striped border-0">
            <tbody id="bodyR">
            </tbody>
        </table>
    </div>
</div>
</div>
</div>
</body>
</html>
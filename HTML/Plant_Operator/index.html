<!DOCTYPE html>
<html lang="en" >
<head>
        <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <link rel="stylesheet" href="index.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script>
        var jsonArray;
        window.onload = function(){
            console.log("sending post to server");
            var json={};
            xmlRequest = new XMLHttpRequest();
            xmlRequest.open("POST", "/Plant_Operator/index", true);
            xmlRequest.setRequestHeader('Content-type', 'application/json');
            xmlRequest.send();
            xmlRequest.onreadystatechange = function(){
                if((xmlRequest.readyState == 4 ) && (xmlRequest.status == 200)){
                    console.log("Got response : ");
                    console.log(xmlRequest.responseText);
                    jsonArray = JSON.parse(xmlRequest.responseText);
                    for(var i=0;i<jsonArray.length;i++)
                    {
                        var json = jsonArray[i];
                        $("#tablePart").append("" +
                            "<tr onclick='clickPart("+i+")'>" +
                            "<td>"+json.PartName+"</td>" +
                            "<td>"+json.Location+"</td>" +
                            "<td>"+json.PartDescription+"</td>" +
                            "<td>"+json.SupplierName+"</td>" +
                            "</tr>");
                    }
                }
            }
        };

    </script>
    <title>Plant Operator</title>
</head>
<body>
<header id="navbar">
    <nav class="navbar navbar-default">
        <div class="container-fluid">
            <div class="navbar-header">
                <div class="navbar-brand">
                    <p>Identifier</p>
                </div>
            </div>
            <ul class="nav navbar-nav">
                <li class="active"><a href="index.html">Home</a></li>
                <li><a href="History.html">History</a></li>
                <li><a href="#">Contact</a></li>
                <li><a href="#">Additional services</a></li>
                <li><a href="#">Offers</a></li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
                <li><img width="41%" src="../Picture/ERC_Logo.png"></li>
                <li><a href="#"><span class="glyphicon glyphicon-log-in"></span> Logout</a></li>
            </ul>

        </div>
    </nav>
</header>
<div id="PartTable" class="col-1">
<table class="table table-striped border-0">
    <thead>
    <tr>
        <td id="PartName">Part Name</td>
        <td id="PartDescription">Part Location</td>
        <td id="PartLocation">Part Description</td>
        <td id="SupplierName">Supplier Name</td>
    </tr>
    </thead>
    <tbody id="tablePart">
    </tbody>
</table>
</div>
<div id="Right">
    <div id="SearchBar">
            <input type="text" class="form-control" id="search" placeholder="Search" onkeyup="searchPart(this.value)">
    </div>
    <div id="ReductionAgent">
        <center><h3 id="TitleRa">Reduction Agent</h3></center>
        <canvas class="center-block" id="myCanvas" width="200" height="100"></canvas>
        <center><div id="Button">
            <a id="BuyButton" class="btn btn-primary" href="#" role="button">Buy</a>
            <a id="ContactButton" class="btn btn-info" href="#" role="button">Contact</a>
        </div></center>
    </div>
</div>
</body>
<script>function searchPart(value)
{

}

var c =document.getElementById("myCanvas");
var ctx = c.getContext("2d");
var grd = ctx.createLinearGradient(0,0,200,0);
grd.addColorStop(0,"red");
grd.addColorStop(1,"blue");
ctx.fillStyle = grd;
function LevelRa(percentage)
{
    return percentage*$("#myCanvas").width()/100;
}
var RaLevel = LevelRa(74);
ctx.fillRect(0,0,RaLevel,100);

function clickPart(IdJson)
{
    xmlRequest = new XMLHttpRequest();
    xmlRequest.open("POST", "/Plant_Operator/PartDescription", true);
    xmlRequest.setRequestHeader('Content-type', 'application/json');
    xmlRequest.send(jsonArray[IdJson]);
    sessionStorage.setItem("SelectedPart", JSON.stringify(jsonArray[IdJson]));
    window.location.replace("/Plant_Operator/PartDescription.html");
}
</script>
</html>